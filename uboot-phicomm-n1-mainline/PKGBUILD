# U-Boot: phicomm-n1
# Maintainer: Pu Xiongfei <pu.xiongfei@qq.com>

buildarch=8

pkgname=uboot-phicomm-n1-mainline
pkgver=2022.07
pkgrel=1
pkgdesc="Mainline U-Boot for phicomm-n1"
arch=('aarch64')
url='http://www.denx.de/wiki/U-Boot/WebHome'
license=('GPL')
install=$pkgname.install
makedepends=('git' 'bc')
backup=('boot/boot.txt' 'boot/boot.scr')
source=("ftp://ftp.denx.de/pub/u-boot/u-boot-${pkgver}.tar.bz2"
        "https://github.com/PuXiongfei/phicomm-n1-u-boot/releases/download/${pkgver}/u-boot.bin"
        'aml_autoscript.txt'
        'emmc_autoscript.txt'
        's905_autoscript.txt'
        'env_default.txt'
        'boot.txt'
        'mkscr')
md5sums=('00000000000000000000000000000000'
         '00000000000000000000000000000000'
         '00000000000000000000000000000000'
         '00000000000000000000000000000000'
         '00000000000000000000000000000000'
         '00000000000000000000000000000000'
         '4258258571f02d00d4b38d03b563dc2b'
         '021623a04afd29ac3f368977140cfbfd')

build() {
}

package() {
  install -d "${pkgdir}"/boot
  u-boot-${pkgver}/tools/mkimage -A arm -O linux -T script -C none -n "aml_autoscript" -d aml_autoscript.txt "${pkgdir}"/boot/aml_autoscript
  u-boot-${pkgver}/tools/mkimage -A arm -O linux -T script -C none -n "emmc_autoscript" -d emmc_autoscript.txt "${pkgdir}"/boot/emmc_autoscript
  u-boot-${pkgver}/tools/mkimage -A arm -O linux -T script -C none -n "s905_autoscript" -d s905_autoscript.txt "${pkgdir}"/boot/s905_autoscript
  u-boot-${pkgver}/tools/mkimage -A arm -O linux -T script -C none -n "env_default" -d env_default.txt "${pkgdir}"/boot/env_default
  u-boot-${pkgver}/tools/mkimage -A arm -O linux -T script -C none -n "U-Boot boot script" -d boot.txt "${pkgdir}"/boot/boot.scr
  cp boot.txt mkscr u-boot.bin "${pkgdir}"/boot
}
